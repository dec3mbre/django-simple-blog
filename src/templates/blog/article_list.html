{% extends "base.html" %}
{% load static %}

{% block title %}Все статьи / Dev Notes{% endblock %}
{% block meta %}
<meta name="description" content="Все статьи об инженерии, инструментах и продуктовом мастерстве." />
{% endblock %}

{% block header %}
{% include "includes/header_main.html" with active_nav="articles" %}
{% endblock %}

{% block content %}
<section class="mx-auto w-full max-w-5xl px-6 pb-16">
    <!-- Search -->
    <div class="fade-up">
        <form method="get" action="{% url 'blog:article_list' %}">
            <div class="relative">
                <svg class="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-white/40" fill="none"
                    stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                </svg>
                <input type="text" id="search-input" name="q" value="{{ request.GET.q|default:'' }}"
                    placeholder="Поиск статей..."
                    class="mono w-full rounded-xl border border-white/10 bg-white/5 py-4 pl-12 pr-4 text-sm text-white placeholder-white/40 focus:border-white/30 focus:outline-none focus:ring-0 transition-colors" />
            </div>
        </form>
    </div>

    <!-- Tag Filters -->
    <div class="fade-up mt-6 flex overflow-x-auto pb-2 no-scrollbar gap-2" id="tag-filters">
        <a href="{% url 'blog:article_list' %}{% if search_query %}?q={{ search_query }}{% endif %}"
            class="tag-filter mono rounded-full border px-4 py-2 text-xs uppercase tracking-[0.25em] transition-all whitespace-nowrap {% if not current_category %}border-white/20 text-white/70 active{% else %}border-white/10 text-white/50 hover:border-white/30 hover:text-white/70{% endif %}">
            Все
        </a>
        {% for category in categories %}
        <a href="{% url 'blog:article_list' %}?category={{ category.slug }}{% if search_query %}&q={{ search_query }}{% endif %}"
            class="tag-filter mono rounded-full border px-4 py-2 text-xs uppercase tracking-[0.25em] transition-all whitespace-nowrap {% if current_category == category.slug %}border-white/20 text-white/70 active{% else %}border-white/10 text-white/50 hover:border-white/30 hover:text-white/70{% endif %}">
            {{ category.name }}
        </a>
        {% endfor %}
    </div>

    <!-- Results count -->
    <div class="mt-6 flex items-center justify-between">
        <p class="mono text-xs uppercase tracking-[0.3em] text-white/50">
            <span id="results-count">{{ page_obj.paginator.count|default:articles|length }}</span> статей
        </p>
    </div>

    <!-- Articles Grid -->
    <div class="mt-6 grid gap-5 md:grid-cols-2 lg:grid-cols-3" id="articles-grid">
        {% for article in articles %}
        {% include "includes/article_card.html" %}
        {% endfor %}
    </div>

    <!-- Empty state -->
    {% if not articles %}
    <div id="empty-state" class="mt-12 text-center">
        <p class="mono text-sm uppercase tracking-[0.3em] text-white/40">Статьи не найдены</p>
    </div>
    {% else %}
    <div id="empty-state" class="hidden mt-12 text-center">
        <p class="mono text-sm uppercase tracking-[0.3em] text-white/40">Статьи не найдены</p>
    </div>
    {% endif %}

    <!-- Pagination -->
    {% if page_obj %}
    {% include "includes/pagination.html" %}
    {% endif %}
</section>
{% endblock %}

{% block footer %}
{% include "includes/footer.html" %}
{% endblock %}
